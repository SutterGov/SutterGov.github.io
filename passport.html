<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sutter Republic II è¨ç‰¹æŠ¤ç…§åœ¨çº¿ç”³é¢†é¡µé¢</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", "Noto Sans TC", sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #1a237e;
            margin-bottom: 30px;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .main-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 968px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }

        /* è¡¨å–®å€åŸŸ */
        .form-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            max-height: 90vh;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
            font-size: 0.9rem;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        input[type="text"],
        input[type="date"],
        select {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 0.95rem;
            transition: all 0.3s;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        input[type="text"]:focus,
        input[type="date"]:focus,
        select:focus {
            outline: none;
            border-color: #1a237e;
            box-shadow: 0 0 0 3px rgba(26,35,126,0.1);
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            display: block;
            padding: 10px 15px;
            background: #1a237e;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .file-input-label:hover {
            background: #283593;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(26,35,126,0.3);
        }

        .type-selector {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .type-option {
            flex: 1;
            min-width: 70px;
        }

        .type-option input {
            display: none;
        }

        .type-option label {
            display: block;
            padding: 8px 5px;
            text-align: center;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.85rem;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .type-option input:checked + label.type-foreign {
            background: #E3F2FD;
            border-color: #2196F3;
            color: #1565C0;
        }

        .type-option input:checked + label.type-business {
            background: #FFFDE7;
            border-color: #FBC02D;
            color: #F57F17;
        }

        .type-option input:checked + label.type-official {
            background: #FFEBEE;
            border-color: #E53935;
            color: #C62828;
        }

        .type-option input:checked + label.type-private {
            background: #E8F5E9;
            border-color: #43A047;
            color: #2E7D32;
        }

        .location-selects {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
        }

        .generate-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #1a237e 0%, #3949ab 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(26,35,126,0.3);
        }

        /* è­·ç…§å°é–‹æœ¬å®¹å™¨ */
        .passport-book {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin: 0 auto;
            perspective: 1500px;
            filter: drop-shadow(0 20px 40px rgba(0,0,0,0.3));
        }

        .passport-pages {
            display: flex;
            flex-direction: column;
            gap: 0;
            position: relative;
        }

        /* é é¢ä¹‹é–“çš„é™°å½±æ•ˆæœ */
        .passport-page {
            position: relative;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 
                0 -10px 30px rgba(0,0,0,0.1),
                0 5px 15px rgba(0,0,0,0.2);
            margin-bottom: -5px;
            z-index: 10;
        }

        .passport-page:first-child {
            z-index: 20;
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
            margin-bottom: -10px;
            box-shadow: 
                0 15px 35px rgba(0,0,0,0.2),
                inset 0 -10px 20px rgba(0,0,0,0.05);
        }

        .passport-page:last-child {
            border-top-left-radius: 0;
            border-top-right-radius: 0;
            z-index: 5;
            box-shadow: 
                0 10px 30px rgba(0,0,0,0.2),
                inset 0 10px 20px rgba(0,0,0,0.03);
        }

        /* ä¸­é–“è£è¨‚ç·šæ•ˆæœ */
        .binding-line {
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(to right, 
                rgba(0,0,0,0.1) 0%, 
                rgba(0,0,0,0.05) 50%, 
                rgba(0,0,0,0.1) 100%);
            z-index: 100;
        }

        /* è­·ç…§å…§é å®¹å™¨ */
        .passport-container {
            width: 100%;
            aspect-ratio: 1.4;
            position: relative;
            overflow: hidden;
        }

        /* é˜²å½èƒŒæ™¯ç´‹æ¨£ */
        .passport-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }

        /* æ³¢æµªç·šèŠ±ç´‹ */
        .wave-pattern {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0.08;
            background-image: 
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 15px,
                    rgba(26,35,126,0.3) 15px,
                    rgba(26,35,126,0.3) 17px
                );
        }

        .wave-pattern-2 {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0.06;
            background-image: 
                repeating-linear-gradient(
                    -45deg,
                    transparent,
                    transparent 20px,
                    rgba(26,35,126,0.2) 20px,
                    rgba(26,35,126,0.2) 22px
                );
        }

        /* æ›²ç·šèŠ±ç´‹ */
        .curve-pattern {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0.05;
            background-image: radial-gradient(
                circle at 50% 50%,
                transparent 30%,
                rgba(26,35,126,0.4) 31%,
                rgba(26,35,126,0.4) 32%,
                transparent 33%
            ),
            radial-gradient(
                circle at 0% 0%,
                transparent 20%,
                rgba(26,35,126,0.3) 21%,
                rgba(26,35,126,0.3) 22%,
                transparent 23%
            );
            background-size: 80px 80px, 120px 120px;
        }

        .guilloche-pattern {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0.1;
            background-image: 
                repeating-radial-gradient(circle at 0 0, transparent 0, rgba(0,0,0,0.03) 10px),
                repeating-radial-gradient(circle at 100% 100%, transparent 0, rgba(0,0,0,0.03) 10px);
            background-size: 40px 40px, 60px 60px;
        }

        .security-lines {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0.08;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 30px,
                rgba(0,0,0,0.1) 30px,
                rgba(0,0,0,0.1) 31px
            );
        }

        .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-30deg);
            font-size: 3.5rem;
            opacity: 0.06;
            font-weight: bold;
            color: #1a237e;
            pointer-events: none;
            letter-spacing: 5px;
            text-align: center;
            line-height: 1.3;
            z-index: 1;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .microtext {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0.06;
            font-size: 5px;
            line-height: 7px;
            word-wrap: break-word;
            overflow: hidden;
            color: #1a237e;
            padding: 20px;
            z-index: 1;
        }

        /* ä¸åŒé¡å‹çš„èƒŒæ™¯è‰² */
        .passport-container.type-foreign-bg { background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); }
        .passport-container.type-business-bg { background: linear-gradient(135deg, #FFFDE7 0%, #FFF9C4 100%); }
        .passport-container.type-official-bg { background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%); }
        .passport-container.type-private-bg { background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%); }

        .passport-content {
            position: relative;
            z-index: 10;
            padding: 25px 25px 25px 35px;
            height: 100%;
            display: grid;
            grid-template-columns: 130px 1fr;
            gap: 15px;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .passport-header {
            grid-column: 1 / -1;
            text-align: center;
            border-bottom: 2px solid rgba(0,0,0,0.1);
            padding-bottom: 8px;
            margin-bottom: 8px;
        }

        .passport-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1a237e;
            letter-spacing: 1px;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .passport-subtitle {
            font-size: 0.75rem;
            color: #666;
            margin-top: 3px;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .photo-section {
            display: flex;
            flex-direction: column;
            gap: 10px;
            position: relative;
        }

        .photo-container {
            width: 110px;
            height: 140px;
            border: 3px solid rgba(0,0,0,0.2);
            border-radius: 5px;
            overflow: hidden;
            background: white;
            position: relative;
        }

        .photo-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f0f0f0;
            color: #999;
            font-size: 0.75rem;
            text-align: center;
            padding: 10px;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        /* è“‹ç« æ•ˆæœçš„ç°½å */
        .stamp-signature {
            width: 110px;
            height: 110px;
            border: 3px solid rgba(198, 40, 40, 0.4);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            transform: rotate(-15deg);
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            margin-top: 10px;
        }

        .stamp-signature::before {
            content: '';
            position: absolute;
            top: 5px;
            left: 5px;
            right: 5px;
            bottom: 5px;
            border: 1px solid rgba(198, 40, 40, 0.3);
            border-radius: 50%;
        }

        .stamp-text {
            font-size: 0.75rem;
            color: rgba(198, 40, 40, 0.7);
            font-weight: bold;
            text-align: center;
            line-height: 1.2;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
            letter-spacing: 1px;
        }

        .stamp-name {
            font-size: 0.9rem;
            color: rgba(198, 40, 40, 0.8);
            font-weight: 900;
            margin-top: 5px;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .info-section {
            display: grid;
            gap: 10px;
        }

        .info-row {
            display: grid;
            grid-template-columns: 90px 1fr;
            align-items: baseline;
            gap: 8px;
        }

        .info-label {
            font-size: 0.7rem;
            color: #555;
            font-weight: 500;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .info-value {
            font-size: 0.95rem;
            font-weight: 600;
            color: #1a237e;
            border-bottom: 1px solid rgba(0,0,0,0.15);
            padding-bottom: 2px;
            min-height: 1.4rem;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .passport-number-display {
            font-family: 'Courier New', monospace !important;
            font-size: 1.2rem;
            letter-spacing: 2px;
            color: #c62828;
            font-weight: bold;
        }

        .mrz-section {
            grid-column: 1 / -1;
            background: rgba(0,0,0,0.05);
            padding: 8px;
            border-radius: 4px;
            margin-top: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            letter-spacing: 1px;
            line-height: 1.5;
            word-break: break-all;
        }

        .ghost-photo {
            position: absolute;
            right: 25px;
            top: 45%;
            width: 90px;
            height: 115px;
            opacity: 0.25;
            border-radius: 5px;
            overflow: hidden;
            filter: grayscale(100%);
            mix-blend-mode: multiply;
            z-index: 5;
        }

        .ghost-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .nationality-display {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .nationality-display .primary {
            font-weight: 700;
        }

        .nationality-display .secondary {
            font-weight: 400;
            color: #666;
            font-size: 0.85rem;
        }

        /* è“‹ç« é æ¨£å¼ */
        .stamp-page {
            background: linear-gradient(135deg, #fafafa 0%, #f0f0f0 100%);
            padding: 30px;
            min-height: 400px;
            position: relative;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .stamp-page-header {
            text-align: center;
            border-bottom: 2px solid #1a237e;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .stamp-page-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #1a237e;
            letter-spacing: 2px;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .visa-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .visa-box {
            aspect-ratio: 1;
            border: 2px dashed #ccc;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.5);
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
        }

        .visa-box:hover {
            border-color: #1a237e;
            background: rgba(26,35,126,0.05);
        }

        .visa-stamp {
            width: 70px;
            height: 70px;
            border: 3px solid #c62828;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transform: rotate(-20deg);
            opacity: 0.8;
            font-size: 0.7rem;
            color: #c62828;
            font-weight: bold;
            text-align: center;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .visa-text {
            margin-top: 8px;
            font-size: 0.75rem;
            color: #666;
            text-align: center;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .official-stamp-large {
            position: absolute;
            bottom: 30px;
            right: 30px;
            width: 150px;
            height: 150px;
            border: 4px solid rgba(198, 40, 40, 0.6);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transform: rotate(-25deg);
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 70%);
            opacity: 0.9;
        }

        .official-stamp-large::before {
            content: '';
            position: absolute;
            top: 8px;
            left: 8px;
            right: 8px;
            bottom: 8px;
            border: 2px solid rgba(198, 40, 40, 0.4);
            border-radius: 50%;
        }

        .official-stamp-text {
            font-size: 0.85rem;
            color: rgba(198, 40, 40, 0.9);
            font-weight: 900;
            text-align: center;
            line-height: 1.3;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .passport-note {
            margin-top: 20px;
            padding: 15px;
            background: rgba(26,35,126,0.05);
            border-left: 4px solid #1a237e;
            border-radius: 0 8px 8px 0;
            font-size: 0.8rem;
            color: #555;
            line-height: 1.6;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
        }

        .preview-controls {
            margin-top: 20px;
            text-align: center;
        }

        .download-btn {
            display: inline-block;
            padding: 12px 30px;
            background: linear-gradient(135deg, #2e7d32 0%, #43a047 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: "Microsoft YaHei", "å¾®è»Ÿé›…é»‘", sans-serif;
            box-shadow: 0 4px 15px rgba(46,125,50,0.3);
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(46,125,50,0.4);
        }

        .download-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
    </style>
<base target="_blank">
</head>
<body>
    <div class="container">
        <h1>ğŸ›ï¸ Sutter Republic II æŠ¤ç…§åœ¨çº¿ç”³é¢†é¡µé¢</h1>

        <div class="main-layout">
            <!-- è¡¨å–®å€åŸŸ -->
            <div class="form-section">
                <h2 style="margin-bottom: 15px; color: #1a237e; font-family: Microsoft YaHei;">å¡«å¯«è³‡æ–™</h2>

                <div class="form-group">
                    <label>è­·ç…§é¡å‹ (Type)</label>
                    <div class="type-selector">
                        <div class="type-option">
                            <input type="radio" name="passportType" id="typeForeign" value="foreign" checked>
                            <label for="typeForeign" class="type-foreign">å¤–äº‹</label>
                        </div>
                        <div class="type-option">
                            <input type="radio" name="passportType" id="typeBusiness" value="business">
                            <label for="typeBusiness" class="type-business">å•†å‹™</label>
                        </div>
                        <div class="type-option">
                            <input type="radio" name="passportType" id="typeOfficial" value="official">
                            <label for="typeOfficial" class="type-official">å…¬å‹™</label>
                        </div>
                        <div class="type-option">
                            <input type="radio" name="passportType" id="typePrivate" value="private">
                            <label for="typePrivate" class="type-private">ç§äºº</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>å¤§é ­ç…§</label>
                    <div class="file-input-wrapper">
                        <input type="file" id="photoUpload" accept="image/*">
                        <label for="photoUpload" class="file-input-label">ğŸ“· ä¸Šå‚³ç…§ç‰‡</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>å§“æ° (Surname)</label>
                    <input type="text" id="surnameInput" placeholder="è«‹è¼¸å…¥å§“æ°">
                </div>

                <div class="form-group">
                    <label>åå­— (Given Name)</label>
                    <input type="text" id="givenNameInput" placeholder="è«‹è¼¸å…¥åå­—">
                </div>

                <div class="form-group">
                    <label>å‡ºç”Ÿæ—¥æœŸ (Date of Birth)</label>
                    <input type="date" id="dobInput">
                </div>

                <div class="form-group">
                    <label>æ€§åˆ¥ (Sex)</label>
                    <select id="sexInput">
                        <option value="">è«‹é¸æ“‡</option>
                        <option value="M">ç”·</option>
                        <option value="F">å¥³</option>
                        <option value="X">éäºŒå…ƒæ€§åˆ¥</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>ç¬¬äºŒåœ‹ç±ï¼ˆé¸å¡«ï¼‰</label>
                    <input type="text" id="secondNationality" placeholder="å¦‚ç„¡è«‹ç•™ç©º">
                </div>

                <div class="form-group">
                    <label>å‡ºç”Ÿåœ° (Place of Birth)</label>
                    <div class="location-selects">
                        <select id="provinceSelect">
                            <option value="">é¸æ“‡çœ</option>
                            <option value="æ–¯å¡æ‹‰çˆ¾">æ–¯å¡æ‹‰çˆ¾</option>
                            <option value="æ…•å¾·è˜­">æ…•å¾·è˜­</option>
                            <option value="è¥¿æ ¼çˆ¾åŸº">è¥¿æ ¼çˆ¾åŸº</option>
                            <option value="éœåˆ©">éœåˆ©</option>
                            <option value="æ¼¢é™½">æ¼¢é™½</option>
                            <option value="å…¨å·">å…¨å·</option>
                            <option value="å¤šå·´çˆ¾">å¤šå·´çˆ¾</option>
                            <option value="é’å±±">é’å±±</option>
                            <option value="ç¾¤å³¶çœ">ç¾¤å³¶çœ</option>
                            <option value="ç£å€çœ">ç£å€çœ</option>
                            <option value="è–å·´å»·">è–å·´å»·</option>
                            <option value="æ±é«˜åœ°">æ±é«˜åœ°</option>
                            <option value="æŸ¯è¥¿æ¯”">æŸ¯è¥¿æ¯”</option>
                            <option value="å¡ç‘ªçˆ¾å±±">å¡ç‘ªçˆ¾å±±</option>
                            <option value="éŒ«è–©æ‹‰">éŒ«è–©æ‹‰</option>
                            <option value="å·´å³°ç‰¹åˆ¥é ˜åœ°">å·´å³°ç‰¹åˆ¥é ˜åœ°</option>
                            <option value="å¸•åŸºç‰¹">å¸•åŸºç‰¹</option>
                            <option value="éœç´çˆ¾">éœç´çˆ¾</option>
                            <option value="è–©å…±æ§åˆ¶é ˜åœ°">è–©å…±æ§åˆ¶é ˜åœ°</option>
                        </select>
                        <select id="regionSelect">
                            <option value="">é¸æ“‡å¤§å€</option>
                            <option value="/">/</option>
                            <option value="æ¹–ç•”åŸå¸‚ç¾¤">æ¹–ç•”åŸå¸‚ç¾¤</option>
                            <option value="è¥¿åŒ—åŸå¸‚ç¾¤">è¥¿åŒ—åŸå¸‚ç¾¤</option>
                            <option value="æ±éƒ¨åŸå¸‚ç¾¤">æ±éƒ¨åŸå¸‚ç¾¤</option>
                            <option value="å—äº¬å—é“åŸå¸‚ç¾¤">å—äº¬å—é“åŸå¸‚ç¾¤</option>
                            <option value="ç“¦æ—¥æ­£ç·šåŸå¸‚ç¾¤">ç“¦æ—¥æ­£ç·šåŸå¸‚ç¾¤</option>
                            <option value="æ±ä¸‰çœåœ°å€">æ±ä¸‰çœåœ°å€</option>
                            <option value="é¼å¯§åŸå¸‚ç¾¤">é¼å¯§åŸå¸‚ç¾¤</option>
                        </select>
                        <select id="citySelect">
                            <option value="">é¸æ“‡ç‰¹åˆ¥å¸‚</option>
                            <option value="/">/</option>
                            <option value="å“ˆåˆ©è²å…‹é¦–éƒ½ç‰¹å€">å“ˆåˆ©è²å…‹é¦–éƒ½ç‰¹å€</option>
                            <option value="æ–¯å¡è’‚æ–°åŸ">æ–¯å¡è’‚æ–°åŸ</option>
                            <option value="æ¯”è–©æ‹‰è¡›åŸ">æ¯”è–©æ‹‰è¡›åŸ</option>
                            <option value="é›·å…‹ç´æ‹œçˆ¾">é›·å…‹ç´æ‹œçˆ¾</option>
                            <option value="åŒ—æ–¹è‡ªè²¿åŸ">åŒ—æ–¹è‡ªè²¿åŸ</option>
                            <option value="åŸºçˆ¾">åŸºçˆ¾</option>
                            <option value="åšæ¶…å…‹æµ·è»å‡†å°‡åŸ">åšæ¶…å…‹æµ·è»å‡†å°‡åŸ</option>
                            <option value="ç£å€åŸ">ç£å€åŸ</option>
                            <option value="å¤è–©ç‰¹">å¤è–©ç‰¹</option>
                            <option value="ç‹—è›‹å¤§å°‡è»åŸ">ç‹—è›‹å¤§å°‡è»åŸ</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>ç°½ç™¼æ—¥æœŸ (Date of Issue)</label>
                    <input type="date" id="issueDateInput">
                </div>

                <div class="form-group">
                    <label>æœ‰æ•ˆæœŸè‡³ (Date of Expiry)</label>
                    <input type="date" id="expiryDateInput">
                </div>
            </div>

            <!-- é è¦½å€åŸŸ - å°é–‹æœ¬è­·ç…§ -->
            <div class="passport-preview">
                <h2 style="margin-bottom: 20px; color: #1a237e; text-align: center; font-family: Microsoft YaHei;">è­·ç…§é è¦½</h2>

                <div class="passport-book" id="passportBook">
                    <div class="passport-pages">
                        <!-- ç¬¬ä¸€é ï¼šä¿¡æ¯é  -->
                        <div class="passport-page">
                            <div class="binding-line"></div>
                            <div id="passportContainer" class="passport-container type-foreign-bg">
                                <!-- é˜²å½èƒŒæ™¯ -->
                                <div class="passport-background">
                                    <div class="wave-pattern"></div>
                                    <div class="wave-pattern-2"></div>
                                    <div class="curve-pattern"></div>
                                    <div class="guilloche-pattern"></div>
                                    <div class="security-lines"></div>
                                    <div class="watermark">SUTTER<br>REPUBLIC II</div>
                                    <div class="microtext">
                                        SUTTER REPUBLIC II PASSPORT OFFICIAL TRAVEL DOCUMENT SUTTER REPUBLIC II PASSPORT OFFICIAL TRAVEL DOCUMENT 
                                        SUTTER REPUBLIC II PASSPORT OFFICIAL TRAVEL DOCUMENT SUTTER REPUBLIC II PASSPORT OFFICIAL TRAVEL DOCUMENT
                                        SUTTER REPUBLIC II PASSPORT OFFICIAL TRAVEL DOCUMENT SUTTER REPUBLIC II PASSPORT OFFICIAL TRAVEL DOCUMENT
                                    </div>
                                </div>

                                <!-- è­·ç…§å…§å®¹ -->
                                <div class="passport-content">
                                    <div class="passport-header">
                                        <div class="passport-title">Sutter Republic II PASSPORT</div>
                                        <div class="passport-subtitle">è–©ç‰¹ç¬¬äºŒå…±å’Œåœ‹ | è­·ç…§</div>
                                    </div>

                                    <div class="photo-section">
                                        <div class="photo-container" id="mainPhotoContainer">
                                            <div class="photo-placeholder">è«‹ä¸Šå‚³<br>ç…§ç‰‡</div>
                                        </div>
                                        <div class="stamp-signature" id="stampSignature">
                                            <div class="stamp-text">SUTTER RII</div>
                                            <div class="stamp-name" id="stampName"></div>
                                        </div>
                                    </div>

                                    <div class="info-section">
                                        <div class="info-row">
                                            <span class="info-label">é¡å‹/Type</span>
                                            <span class="info-value" id="typeDisplay">P</span>
                                        </div>

                                        <div class="info-row">
                                            <span class="info-label">è­·ç…§è™Ÿç¢¼/No.</span>
                                            <span class="info-value passport-number-display" id="passportNumberDisplay">Z0000000</span>
                                        </div>

                                        <div class="info-row">
                                            <span class="info-label">å§“æ°/Surname</span>
                                            <span class="info-value" id="surnameDisplay"></span>
                                        </div>

                                        <div class="info-row">
                                            <span class="info-label">åå­—/Given Name</span>
                                            <span class="info-value" id="givenNameDisplay"></span>
                                        </div>

                                        <div class="info-row">
                                            <span class="info-label">åœ‹ç±/Nationality</span>
                                            <div class="nationality-display">
                                                <span class="info-value primary" id="nationalityDisplay">Sutter RII</span>
                                                <span class="info-value secondary" id="secondNationalityDisplay"></span>
                                            </div>
                                        </div>

                                        <div class="info-row">
                                            <span class="info-label">å‡ºç”Ÿæ—¥æœŸ/D.O.B</span>
                                            <span class="info-value" id="dobDisplay"></span>
                                        </div>

                                        <div class="info-row">
                                            <span class="info-label">æ€§åˆ¥/Sex</span>
                                            <span class="info-value" id="sexDisplay"></span>
                                        </div>

                                        <div class="info-row">
                                            <span class="info-label">å‡ºç”Ÿåœ°/P.O.B</span>
                                            <span class="info-value" id="pobDisplay"></span>
                                        </div>

                                        <div class="info-row">
                                            <span class="info-label">ç°½ç™¼åœ°/P.O.I</span>
                                            <span class="info-value" id="poiDisplay"></span>
                                        </div>

                                        <div class="two-column">
                                            <div class="info-row" style="grid-template-columns: 70px 1fr;">
                                                <span class="info-label">ç°½ç™¼æ—¥æœŸ</span>
                                                <span class="info-value" id="issueDateDisplay" style="font-size: 0.8rem;"></span>
                                            </div>
                                            <div class="info-row" style="grid-template-columns: 70px 1fr;">
                                                <span class="info-label">æœ‰æ•ˆæœŸè‡³</span>
                                                <span class="info-value" id="expiryDateDisplay" style="font-size: 0.8rem;"></span>
                                            </div>
                                        </div>

                                        <div class="mrz-section" id="mrzDisplay">
                                            P&lt;SR2&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br>
                                            Z0000000&lt;0SR2&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;4
                                        </div>
                                    </div>

                                    <div class="ghost-photo" id="ghostPhotoContainer"></div>
                                </div>
                            </div>
                        </div>

                        <!-- ç¬¬äºŒé ï¼šè“‹ç« é  -->
                        <div class="passport-page">
                            <div class="binding-line"></div>
                            <div class="stamp-page">
                                <div class="stamp-page-header">
                                    <div class="stamp-page-title">ENTRY / EXIT STAMPS</div>
                                    <div style="font-size: 0.8rem; color: #666; margin-top: 5px;">å‡ºå…¥å¢ƒç´€éŒ„é </div>
                                </div>

                                <div class="visa-grid">
                                    <div class="visa-box">
                                        <div class="visa-stamp">å…¥å¢ƒ<br>2024</div>
                                        <div class="visa-text">å“ˆåˆ©è²å…‹é¦–éƒ½ç‰¹å€</div>
                                    </div>
                                    <div class="visa-box">
                                        <div class="visa-stamp" style="border-color: #1565C0; color: #1565C0;">å‡ºå¢ƒ<br>2024</div>
                                        <div class="visa-text">åœ‹éš›æ©Ÿå ´</div>
                                    </div>
                                    <div class="visa-box">
                                        <div class="visa-stamp">å…¥å¢ƒ<br>2025</div>
                                        <div class="visa-text">ç£å€åŸ</div>
                                    </div>
                                    <div class="visa-box">
                                        <div class="visa-stamp" style="opacity: 0.3; border-style: dashed;">é ç•™<br>ç©ºç™½</div>
                                        <div class="visa-text">å¯ç”¨ç©ºä½</div>
                                    </div>
                                    <div class="visa-box">
                                        <div class="visa-stamp" style="opacity: 0.3; border-style: dashed;">é ç•™<br>ç©ºç™½</div>
                                        <div class="visa-text">å¯ç”¨ç©ºä½</div>
                                    </div>
                                    <div class="visa-box">
                                        <div class="visa-stamp" style="opacity: 0.3; border-style: dashed;">é ç•™<br>ç©ºç™½</div>
                                        <div class="visa-text">å¯ç”¨ç©ºä½</div>
                                    </div>
                                </div>

                                <div class="passport-note">
                                    <strong>æ³¨æ„äº‹é …ï¼š</strong><br>
                                    æœ¬è­·ç…§ç‚ºè–©ç‰¹ç¬¬äºŒå…±å’Œåœ‹æ”¿åºœç°½ç™¼ä¹‹æ­£å¼æ—…è¡Œè­‰ä»¶ï¼ŒæŒç…§äººæ‡‰éµå®ˆå„åœ‹æ³•å¾‹ã€‚<br>
                                    è­·ç…§æœ‰æ•ˆæœŸç‚ºåå¹´ï¼ŒæœŸæ»¿å‰æ‡‰ç”³è«‹æ›ç™¼ã€‚<br>
                                    This passport is a valid travel document issued by the Government of Sutter Republic II.
                                </div>

                                <div class="official-stamp-large">
                                    <div class="official-stamp-text">SUTTER<br>REPUBLIC II<br>MINISTRY OF<br>FOREIGN AFFAIRS</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="preview-controls">
                    <button class="download-btn" onclick="downloadPassport()" id="downloadBtn">
                        ğŸ“¥ ä¸‹è¼‰è­·ç…§åœ–ç‰‡
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€è®Šé‡
        let uploadedPhotoData = null;
        let currentPhotoType = 'foreign';

        // é¡è‰²æ˜ å°„
        const typeColors = {
            foreign: { bg: 'type-foreign-bg', code: 'P', color: '#2196F3' },
            business: { bg: 'type-business-bg', code: 'B', color: '#FBC02D' },
            official: { bg: 'type-official-bg', code: 'O', color: '#E53935' },
            private: { bg: 'type-private-bg', code: 'R', color: '#43A047' }
        };

        // ç›£è½é¡å‹é¸æ“‡
        document.querySelectorAll('input[name="passportType"]').forEach(radio => {
            radio.addEventListener('change', function() {
                updatePassportType(this.value);
            });
        });

        function updatePassportType(type) {
            currentPhotoType = type;
            const container = document.getElementById('passportContainer');

            // ç§»é™¤æ‰€æœ‰èƒŒæ™¯é¡
            Object.values(typeColors).forEach(t => container.classList.remove(t.bg));

            // æ·»åŠ æ–°èƒŒæ™¯
            container.classList.add(typeColors[type].bg);

            // æ›´æ–°é¡å‹é¡¯ç¤º
            document.getElementById('typeDisplay').textContent = typeColors[type].code;

            // å¦‚æœæœ‰ç…§ç‰‡ï¼Œé‡æ–°è™•ç†å¹½éˆç…§ç‰‡
            if (uploadedPhotoData) {
                processGhostPhoto(uploadedPhotoData, type);
            }
        }

        // ç›£è½ç…§ç‰‡ä¸Šå‚³
        document.getElementById('photoUpload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    uploadedPhotoData = event.target.result;

                    // é¡¯ç¤ºä¸»ç…§ç‰‡
                    const mainContainer = document.getElementById('mainPhotoContainer');
                    mainContainer.innerHTML = `<img src="${uploadedPhotoData}" alt="è­‰ä»¶ç…§">`;

                    // è™•ç†ä¸¦é¡¯ç¤ºå¹½éˆç…§ç‰‡
                    processGhostPhoto(uploadedPhotoData, currentPhotoType);
                };
                reader.readAsDataURL(file);
            }
        });

        function processGhostPhoto(imageData, type) {
            const ghostContainer = document.getElementById('ghostPhotoContainer');
            const color = typeColors[type].color;

            const img = new Image();
            img.onload = function() {
                const canvas = document.createElement('canvas');
                canvas.width = 90;
                canvas.height = 115;
                const ctx = canvas.getContext('2d');

                ctx.drawImage(img, 0, 0, 90, 115);

                const imageData = ctx.getImageData(0, 0, 90, 115);
                const data = imageData.data;

                for (let i = 0; i < data.length; i += 4) {
                    const gray = data[i] * 0.299 + data[i + 1] * 0.587 + data[i + 2] * 0.114;
                    data[i] = gray;
                    data[i + 1] = gray;
                    data[i + 2] = gray;
                }

                ctx.putImageData(imageData, 0, 0);

                ctx.globalCompositeOperation = 'source-atop';
                ctx.fillStyle = color;
                ctx.globalAlpha = 0.4;
                ctx.fillRect(0, 0, 90, 115);

                ghostContainer.innerHTML = `<img src="${canvas.toDataURL()}" alt="Ghost Photo" style="opacity: 0.6;">`;
            };
            img.src = imageData;
        }

        // ç”Ÿæˆéš¨æ©Ÿè­·ç…§è™Ÿç¢¼
        function generatePassportNumber() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = 'Z';
            for (let i = 0; i < 7; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        // æ—¥æœŸæ ¼å¼åŒ–
        function formatDate(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString);
            return `${String(date.getDate()).padStart(2, '0')}/${String(date.getMonth() + 1).padStart(2, '0')}/${date.getFullYear()}`;
        }

        // ç›£è½è¼¸å…¥è®ŠåŒ–
        document.getElementById('surnameInput').addEventListener('input', function() {
            const val = this.value.toUpperCase();
            document.getElementById('surnameDisplay').textContent = val;
            updateStamp();
        });

        document.getElementById('givenNameInput').addEventListener('input', function() {
            const val = this.value.toUpperCase();
            document.getElementById('givenNameDisplay').textContent = val;
            updateStamp();
        });

        function updateStamp() {
            const surname = document.getElementById('surnameInput').value.toUpperCase();
            const givenName = document.getElementById('givenNameInput').value.toUpperCase();
            const stampName = document.getElementById('stampName');

            if (surname || givenName) {
                stampName.textContent = surname + (givenName ? ' ' + givenName : '');
            } else {
                stampName.textContent = '';
            }
        }

        document.getElementById('secondNationality').addEventListener('input', function() {
            const sec = document.getElementById('secondNationalityDisplay');
            if (this.value) {
                sec.textContent = '/ ' + this.value.toUpperCase();
            } else {
                sec.textContent = '';
            }
        });

        document.getElementById('dobInput').addEventListener('change', function() {
            document.getElementById('dobDisplay').textContent = formatDate(this.value);
        });

        document.getElementById('sexInput').addEventListener('change', function() {
            document.getElementById('sexDisplay').textContent = this.value;
        });

        document.getElementById('issueDateInput').addEventListener('change', function() {
            document.getElementById('issueDateDisplay').textContent = formatDate(this.value);
        });

        document.getElementById('expiryDateInput').addEventListener('change', function() {
            document.getElementById('expiryDateDisplay').textContent = formatDate(this.value);
        });

        // åœ°é»é¸æ“‡
        function updateLocation() {
            const province = document.getElementById('provinceSelect').value;
            const region = document.getElementById('regionSelect').value;
            const city = document.getElementById('citySelect').value;

            let location = '';
            if (province) {
                location = province;
                if (region && region !== '/') {
                    location += ', ' + region;
                }
                if (city && city !== '/') {
                    location += ', ' + city;
                }
            }

            document.getElementById('pobDisplay').textContent = location;
            document.getElementById('poiDisplay').textContent = location;
        }

        document.getElementById('provinceSelect').addEventListener('change', updateLocation);
        document.getElementById('regionSelect').addEventListener('change', updateLocation);
        document.getElementById('citySelect').addEventListener('change', updateLocation);

        // ç”ŸæˆMRZç¢¼
        function generateMRZ() {
            const typeCode = typeColors[currentPhotoType].code;
            const surname = (document.getElementById('surnameInput').value || '').toUpperCase();
            const givenName = (document.getElementById('givenNameInput').value || '').toUpperCase();
            const passportNo = document.getElementById('passportNumberDisplay').textContent;
            const dob = document.getElementById('dobInput').value.replace(/-/g, '').substring(2);
            const sex = document.getElementById('sexInput').value || 'M';
            const expiry = document.getElementById('expiryDateInput').value.replace(/-/g, '').substring(2);

            const line1 = `P<SR2${surname}<<${givenName}<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<`;
            const line2 = `${passportNo}<0SR2${dob}${sex}${expiry}0000000<<<<<<<<<<<<<<4`;

            document.getElementById('mrzDisplay').innerHTML = 
                line1.substring(0, 44) + '<br>' + line2.substring(0, 44);
        }

        // ä¸‹è¼‰è­·ç…§
        function downloadPassport() {
            const btn = document.getElementById('downloadBtn');
            btn.disabled = true;
            btn.textContent = 'ç”Ÿæˆä¸­...';

            const element = document.getElementById('passportBook');

            html2canvas(element, {
                scale: 2,
                useCORS: true,
                allowTaint: true,
                backgroundColor: null,
                logging: false
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `Sutter_Passport_${document.getElementById('passportNumberDisplay').textContent}.png`;
                link.href = canvas.toDataURL();
                link.click();

                btn.disabled = false;
                btn.textContent = 'ğŸ“¥ ä¸‹è¼‰è­·ç…§åœ–ç‰‡';
            }).catch(err => {
                console.error('æˆªåœ–å¤±æ•—:', err);
                alert('ç”Ÿæˆåœ–ç‰‡å¤±æ•—ï¼Œè«‹é‡è©¦');
                btn.disabled = false;
                btn.textContent = 'ğŸ“¥ ä¸‹è¼‰è­·ç…§åœ–ç‰‡';
            });
        }

        // åˆå§‹åŒ–
        updatePassportType('foreign');
        document.getElementById('passportNumberDisplay').textContent = generatePassportNumber();

        // å®šæ™‚æ›´æ–°MRZï¼ˆç•¶ä¿¡æ¯æ”¹è®Šæ™‚ï¼‰
        setInterval(() => {
            if (document.getElementById('surnameInput').value || 
                document.getElementById('givenNameInput').value) {
                generateMRZ();
            }
        }, 2000);
    </script>
</body>
</html>
