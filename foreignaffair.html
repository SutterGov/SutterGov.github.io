<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨ç‰¹ç¬¬äºŒå…±å’Œå›½å»ºäº¤å›½ä¹¦ç”Ÿæˆå™¨ | Sutter Republic II Letter of Credence Generator</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Noto+Serif+SC:wght@400;600;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: "Noto Serif SC", "Playfair Display", serif;
            background: linear-gradient(135deg, #0d1642 0%, #1a237e 50%, #283593 100%);
            min-height: 100vh;
            padding: 20px;
            color: #2c1810;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            text-shadow: 0 4px 6px rgba(0,0,0,0.3);
            margin-bottom: 10px;
            font-family: 'Cinzel', serif;
            letter-spacing: 2px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 380px 1fr;
            gap: 30px;
        }

        @media (max-width: 1100px) {
            .container { grid-template-columns: 1fr; }
        }

        .form-panel {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            height: fit-content;
            border: 2px solid #c9a227;
        }

        .form-title {
            font-size: 1.3rem;
            color: #1a237e;
            margin-bottom: 25px;
            font-weight: 700;
            text-align: center;
            border-bottom: 2px solid #c9a227;
            padding-bottom: 15px;
            font-family: 'Cinzel', serif;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #1a237e;
            font-size: 0.9rem;
        }

        input[type="text"], input[type="file"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.3s;
            font-family: "Noto Serif SC", serif;
        }

        input:focus {
            outline: none;
            border-color: #1a237e;
            box-shadow: 0 0 0 3px rgba(26,35,126,0.1);
        }

        .file-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            border: 2px dashed #1a237e;
            border-radius: 10px;
            cursor: pointer;
            background: #f5f7ff;
            transition: all 0.3s;
            text-align: center;
        }

        .file-label:hover {
            background: #e8eaf6;
            transform: translateY(-2px);
        }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.05rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #1a237e 0%, #3949ab 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(26,35,126,0.3);
        }

        .btn-gold {
            background: linear-gradient(135deg, #c9a227 0%, #f4d03f 100%);
            color: #1a1a1a;
            box-shadow: 0 4px 15px rgba(201,162,39,0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .sutter-info {
            background: linear-gradient(135deg, #e8eaf6 0%, #c5cae9 100%);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #1a237e;
        }

        .sutter-info h4 {
            color: #1a237e;
            margin-bottom: 10px;
        }

        .sutter-info p {
            font-size: 0.85rem;
            color: #555;
            margin-bottom: 5px;
        }

        .sutter-flag-preview {
            width: 100%;
            max-width: 200px;
            height: auto;
            margin-top: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            object-fit: cover;
            display: none;
        }

        .document-preview {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .document-container {
            background: #faf8f0;
            width: 210mm;
            min-height: 297mm;
            padding: 40px 50px;
            box-shadow: 0 0 0 1px #d4af37, 0 0 0 8px #fff, 0 0 0 9px #d4af37, 0 20px 60px rgba(0,0,0,0.4);
            position: relative;
            overflow: hidden;
        }

        @media (max-width: 900px) {
            .document-container {
                width: 100%;
                min-height: auto;
                padding: 30px;
            }
        }

        .document-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(139,69,19,0.03) 2px, rgba(139,69,19,0.03) 4px);
            pointer-events: none;
            z-index: 0;
        }

        .document-content {
            position: relative;
            z-index: 1;
        }

        .doc-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px double #c9a227;
        }

        .doc-emblem {
            width: 80px;
            height: 80px;
            margin: 0 auto 15px;
            background: url('https://i.imgs.ovh/2026/01/28/y9gXK9.png') center/contain no-repeat;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }

        .doc-title {
            font-family: 'Cinzel', serif;
            font-size: 1.6rem;
            color: #1a237e;
            font-weight: 700;
            letter-spacing: 3px;
            margin-bottom: 5px;
        }

        .doc-subtitle {
            font-size: 0.9rem;
            color: #666;
            font-style: italic;
        }

        .nations-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin: 30px 0;
            padding: 20px;
            background: linear-gradient(135deg, rgba(26,35,126,0.05) 0%, rgba(201,162,39,0.05) 100%);
            border-radius: 10px;
            border: 1px solid rgba(201,162,39,0.3);
        }

        .nation-block {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            flex: 1;
        }

        .nation-flag {
            width: 80px;
            height: 53px;
            object-fit: cover;
            border: 2px solid #c9a227;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            margin-bottom: 10px;
            background: #f0f0f0;
        }

        .nation-name {
            font-weight: 700;
            color: #1a237e;
            font-size: 1rem;
            margin-bottom: 3px;
        }

        .nation-name-en {
            font-size: 0.75rem;
            color: #666;
            font-style: italic;
        }

        .diplomatic-symbol {
            font-size: 2rem;
            color: #c9a227;
            margin: 0 20px;
            align-self: center;
        }

        .doc-body {
            margin: 30px 0;
            line-height: 1.8;
            text-align: justify;
        }

        .doc-date {
            text-align: center;
            margin-bottom: 25px;
            font-weight: 600;
            color: #1a237e;
            font-size: 0.95rem;
            letter-spacing: 1px;
        }

        .doc-section {
            margin-bottom: 25px;
        }

        .doc-section h3 {
            font-family: 'Cinzel', serif;
            color: #1a237e;
            font-size: 1.1rem;
            margin-bottom: 15px;
            border-left: 4px solid #c9a227;
            padding-left: 12px;
        }

        .doc-text {
            font-size: 0.9rem;
            text-indent: 2em;
            margin-bottom: 15px;
        }

        .doc-text-fr {
            font-size: 0.85rem;
            text-indent: 2em;
            margin-bottom: 15px;
            font-style: italic;
            color: #444;
            border-left: 2px solid #c9a227;
            padding-left: 15px;
            margin-left: 10px;
        }

        .signatures {
            margin-top: 50px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
        }

        .signature-block {
            text-align: center;
        }

        .signature-line {
            border-bottom: 1px solid #333;
            height: 50px;
            margin-bottom: 8px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            font-family: 'Playfair Display', cursive;
            font-size: 1.3rem;
            font-style: italic;
            color: #2c1810;
        }

        .signature-label {
            font-size: 0.8rem;
            color: #666;
        }

        .signature-title {
            font-weight: 700;
            color: #1a237e;
            font-size: 0.85rem;
            margin-top: 5px;
        }

        .doc-footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #c9a227;
            text-align: center;
            font-size: 0.75rem;
            color: #888;
        }

        .seal {
            position: absolute;
            bottom: 60px;
            right: 60px;
            width: 100px;
            height: 100px;
            border: 3px solid #c9a227;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.15;
            transform: rotate(-15deg);
            font-size: 0.7rem;
            text-align: center;
            color: #1a237e;
            font-weight: 700;
            pointer-events: none;
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: none;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            z-index: 1000;
        }

        .note {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            color: white;
            font-size: 0.85rem;
            text-align: center;
            max-width: 210mm;
        }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loading">æ­£åœ¨ç”Ÿæˆå›½ä¹¦...</div>

    <div class="header">
        <h1>ğŸ“œ è¨ç‰¹ç¬¬äºŒå…±å’Œå›½å»ºäº¤å›½ä¹¦ç”Ÿæˆå™¨</h1>
        <p>Diplomatic Letter of Credence Generator</p>
    </div>

    <div class="container">
        <div class="form-panel">
            <div class="form-title">ğŸ“ å»ºäº¤ç”³è¯·ä¿¡æ¯</div>

            <div class="form-group">
                <label>ç”³è¯·å›½ä¸­æ–‡å</label>
                <input type="text" id="countryZh" placeholder="å¦‚ï¼šæ³•å…°è¥¿å…±å’Œå›½" value="æ³•å…°è¥¿å…±å’Œå›½">
            </div>

            <div class="form-group">
                <label>ç”³è¯·å›½å¤–æ–‡å</label>
                <input type="text" id="countryEn" placeholder="å¦‚ï¼šFrench Republic" value="French Republic">
            </div>

            <div class="form-group">
                <label>ç”³è¯·å›½å›½æ——</label>
                <input type="file" id="flagUpload" accept="image/*" style="display: none;">
                <label for="flagUpload" class="file-label">
                    <span style="font-size: 1.5rem;">ğŸ³ï¸</span>
                    <span>ç‚¹å‡»ä¸Šä¼ å›½æ——å›¾ç‰‡</span>
                </label>
            </div>

            <div class="form-group">
                <label>å¤–äº¤ä»£è¡¨ç­¾å</label>
                <input type="text" id="signature" placeholder="å¦‚ï¼šJean Dupont" value="Jean Dupont">
            </div>

            <button class="btn btn-primary" onclick="updateDocument()">âœ¨ ç”Ÿæˆå›½ä¹¦é¢„è§ˆ</button>
            <button class="btn btn-gold" onclick="downloadDocument()">ğŸ“œ ä¸‹è½½å»ºäº¤å›½ä¹¦</button>

            <div class="sutter-info">
                <h4>ğŸ‡ºğŸ‡³ è¨ç‰¹ç¬¬äºŒå…±å’Œå›½ä¿¡æ¯</h4>
                <p><strong>ä¸­æ–‡åï¼š</strong>è¨ç‰¹ç¬¬äºŒå…±å’Œå›½</p>
                <p><strong>å¤–æ–‡åï¼š</strong>Sutter Republic II</p>
                <p><strong>å¤–äº¤ä»£è¡¨ï¼š</strong>Schnekov</p>
                
                <div class="form-group" style="margin-top: 15px;">
                    <label style="font-size: 0.85rem; color: #1a237e;">è¨ç‰¹ç¬¬äºŒå…±å’Œå›½å›½æ——</label>
                    <input type="file" id="sutterFlagUpload" accept="image/*" style="display: none;">
                    <label for="sutterFlagUpload" class="file-label" style="padding: 12px; margin-top: 5px;">
                        <span style="font-size: 1.2rem;">ğŸ´</span>
                        <span style="font-size: 0.85rem;">ç‚¹å‡»ä¸Šä¼ è¨ç‰¹å›½æ——</span>
                    </label>
                    <img src="" class="sutter-flag-preview" id="sutterFlagPreview" alt="è¨ç‰¹ç¬¬äºŒå…±å’Œå›½å›½æ——é¢„è§ˆ">
                </div>
            </div>
        </div>

        <div class="document-preview">
            <div class="document-container" id="document">
                <div class="document-content">
                    <div class="doc-header">
                        <div class="doc-emblem"></div>
                        <div class="doc-title">è” åˆ å…¬ æŠ¥</div>
                        <div class="doc-subtitle">CommuniquÃ© Conjoint / Joint CommuniquÃ©</div>
                    </div>

                    <div class="nations-header">
                        <div class="nation-block">
                            <img src="" class="nation-flag" id="sutterFlagDisplay" alt="è¨ç‰¹ç¬¬äºŒå…±å’Œå›½" style="display: none;" crossOrigin="anonymous">
                            <div class="nation-flag" id="sutterFlagPlaceholder" style="background: linear-gradient(135deg, #1a237e 0%, #283593 100%); display: flex; align-items: center; justify-content: center; font-size: 0.65rem; color: white; text-align: center; line-height: 1.2;">è¨ç‰¹ç¬¬äºŒå…±å’Œå›½<br>Sutter R. II</div>
                            <div class="nation-name">è¨ç‰¹ç¬¬äºŒå…±å’Œå›½</div>
                            <div class="nation-name-en">Sutter Republic II</div>
                        </div>

                        <div class="diplomatic-symbol">ğŸ¤</div>

                        <div class="nation-block">
                            <img src="" class="nation-flag" id="countryFlagDisplay" style="display: none;" crossOrigin="anonymous">
                            <div class="nation-flag" id="flagPlaceholder" style="background: linear-gradient(135deg, #ddd 0%, #bbb 100%); display: flex; align-items: center; justify-content: center; font-size: 0.7rem; color: #666;">å¾…ä¸Šä¼ </div>
                            <div class="nation-name" id="countryNameDisplay">æ³•å…°è¥¿å…±å’Œå›½</div>
                            <div class="nation-name-en" id="countryNameEnDisplay">French Republic</div>
                        </div>
                    </div>

                    <div class="doc-date">
                        <span id="currentDate"></span>
                    </div>

                    <div class="doc-body">
                        <div class="doc-section">
                            <h3>ä¸­æ–‡æ–‡æœ¬ Texte Chinois</h3>
                            <p class="doc-text">
                                ç­¾ç½²æœ¬è”åˆå…¬æŠ¥ï¼Œæ—¨åœ¨å·©å›ºä¸¤å›½çš„å¤–äº¤åŸºç¡€ï¼Œæ¨è¿›æ”¿æ²»ã€ç»è´¸ã€ç§‘æŠ€ã€æ–‡åŒ–ç­‰å¤šå±‚é¢åˆä½œï¼Œå¹¶ä»¥æ­¤ä¸ºä¸¤å›½å…³ç³»æ–°ç¯‡ç« ä¹‹å¼€ç«¯ã€‚åŒæ–¹è¡¨ç¤ºï¼Œå°†ä»¥å’Œå¹³ä¸ºå¯¼å‘ã€ä»¥äººæ°‘ç¦ç¥‰ä¸ºæ ¸å¿ƒè€Œå»ºç«‹å¤–äº¤å…³ç³»ï¼Œå…±åŒæºæ‰‹åº”å¯¹å…¨çƒæŒ‘æˆ˜ï¼Œä¿ƒè¿›åœ°åŒºå’Œå›½é™…é—´çš„ç¨³å®šä¸åˆä½œã€‚
                            </p>
                            <p class="doc-text">
                                åŒæ–¹ä¸€è‡´è®¤ä¸ºï¼Œä»Šæ—¥è”åˆå…¬æŠ¥ä¹‹ç­¾ç½²ä¸ä»…æ˜¯å¤–äº¤è¡ŒåŠ¨çš„å»¶ç»­ï¼Œä¹Ÿæ˜¯å‹è°Šå’Œä¿¡ä»»çš„å…·ä½“ä½“ç°ã€‚åŒæ–¹åœ¨æœªæ¥å°†æŒç»­åŠ å¼ºæ²Ÿé€šã€æ·±åŒ–äº’ä¿¡ï¼Œä¾æ®è”åˆå…¬æŠ¥çš„åŸåˆ™ï¼ŒæŒç»­æ¨è¿›åŒæ–¹æ›´ç´§å¯†çš„åˆä½œï¼Œå¼€åˆ›å’Œè°ç¹è£çš„æ–°æ—¶ä»£ã€‚
                            </p>
                        </div>

                        <div class="doc-section">
                            <h3>æ³•æ–‡æ–‡æœ¬ Texte FranÃ§ais</h3>
                            <p class="doc-text-fr">
                                La signature de ce communiquÃ© conjoint vise Ã  consolider les fondements diplomatiques entre les deux pays, Ã  promouvoir la coopÃ©ration Ã  tous les niveaux dans les domaines politique, Ã©conomique, commercial, scientifique et technologique, culturel et autres, et Ã  marquer l'ouverture d'une nouvelle Ã¨re dans les relations bilatÃ©rales. Les deux parties ont dÃ©clarÃ© vouloir Ã©tablir des relations diplomatiques fondÃ©es sur la paix et le bien-Ãªtre de leurs populations, relever ensemble les dÃ©fis mondiaux et promouvoir la stabilitÃ© et la coopÃ©ration rÃ©gionales et internationales.
                            </p>
                            <p class="doc-text-fr">
                                Les deux parties ont convenu que la signature de ce communiquÃ© conjoint aujourd'hui s'inscrit non seulement dans la continuitÃ© des actions diplomatiques entreprises, mais constitue Ã©galement une manifestation concrÃ¨te d'amitiÃ© et de confiance. Ã€ l'avenir, les deux parties continueront de renforcer leur communication, d'approfondir leur confiance mutuelle et, conformÃ©ment aux principes du prÃ©sent communiquÃ© conjoint, de dÃ©velopper une coopÃ©ration toujours plus Ã©troite afin d'inaugurer une nouvelle Ã¨re d'harmonie et de prospÃ©ritÃ©.
                            </p>
                        </div>
                    </div>

                    <div class="signatures">
                        <div class="signature-block">
                            <div class="signature-line" id="sutterSignature">Schnekov</div>
                            <div class="signature-label">è¨ç‰¹ç¬¬äºŒå…±å’Œå›½ä»£è¡¨</div>
                            <div class="signature-title">Representative of Sutter Republic II</div>
                        </div>

                        <div class="signature-block">
                            <div class="signature-line" id="countrySignature">Jean Dupont</div>
                            <div class="signature-label" id="countryLabel">æ³•å…°è¥¿å…±å’Œå›½ä»£è¡¨</div>
                            <div class="signature-title" id="countryTitleEn">Representative of French Republic</div>
                        </div>
                    </div>

                    <div class="doc-footer">
                        æœ¬æ–‡ä»¶ä¸€å¼ä¸¤ä»½ï¼Œä»¥ä¸­æ–‡å’Œæ³•æ–‡ä¹¦å°±ï¼Œä¸¤ç§æ–‡æœ¬åŒç­‰ä½œå‡†ã€‚<br>
                        Fait en deux exemplaires, en langues chinoise et franÃ§aise, les deux textes faisant Ã©galement foi.
                    </div>

                    <div class="seal">
                        MINISTRY OF<br>FOREIGN AFFAIRS<br>SUTTER RII
                    </div>
                </div>
            </div>

            <div class="note">
                ğŸ’¡ æç¤ºï¼šè¯·ç¡®ä¿ä¸Šä¼ çš„å›½æ——å›¾ç‰‡æ¸…æ™°ï¼Œå»ºè®®å°ºå¯¸ä¸º 300Ã—200 åƒç´ ä»¥ä¸Šã€‚ç”Ÿæˆçš„å›½ä¹¦é‡‡ç”¨ A4 å°ºå¯¸ï¼ˆ210Ã—297mmï¼‰ï¼Œé€‚åˆæ‰“å°å­˜æ¡£ã€‚
            </div>
        </div>
    </div>

    <script>
        const dateOptions = { year: 'numeric', month: 'long', day: 'numeric' };
        const currentDate = new Date().toLocaleDateString('zh-CN', dateOptions);
        document.getElementById('currentDate').textContent = currentDate;

        // ç”³è¯·å›½å›½æ——ä¸Šä¼ 
        document.getElementById('flagUpload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = document.getElementById('countryFlagDisplay');
                    img.src = event.target.result;
                    img.style.display = 'block';
                    document.getElementById('flagPlaceholder').style.display = 'none';
                };
                reader.readAsDataURL(file);
            }
        });

        // è¨ç‰¹ç¬¬äºŒå…±å’Œå›½å›½æ——ä¸Šä¼ 
        document.getElementById('sutterFlagUpload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    // æ›´æ–°æ–‡æ¡£ä¸­çš„å›½æ——
                    const imgDisplay = document.getElementById('sutterFlagDisplay');
                    imgDisplay.src = event.target.result;
                    imgDisplay.style.display = 'block';
                    document.getElementById('sutterFlagPlaceholder').style.display = 'none';
                    
                    // æ›´æ–°é¢„è§ˆå›¾
                    const imgPreview = document.getElementById('sutterFlagPreview');
                    imgPreview.src = event.target.result;
                    imgPreview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        });

        function updateDocument() {
            const countryZh = document.getElementById('countryZh').value || 'ç”³è¯·å›½';
            const countryEn = document.getElementById('countryEn').value || 'Country';
            const signature = document.getElementById('signature').value || 'ç­¾å';

            document.getElementById('countryNameDisplay').textContent = countryZh;
            document.getElementById('countryNameEnDisplay').textContent = countryEn;
            document.getElementById('countrySignature').textContent = signature;
            document.getElementById('countryLabel').textContent = countryZh + 'ä»£è¡¨';
            document.getElementById('countryTitleEn').textContent = 'Representative of ' + countryEn;
        }

        async function downloadDocument() {
            const loading = document.getElementById('loading');
            loading.style.display = 'flex';

            const images = document.getElementById('document').getElementsByTagName('img');
            const loadPromises = Array.from(images).map(img => {
                if (img.complete) return Promise.resolve();
                return new Promise(resolve => {
                    img.onload = resolve;
                    img.onerror = resolve;
                });
            });

            await Promise.all(loadPromises);

            const element = document.getElementById('document');

            try {
                const canvas = await html2canvas(element, {
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    backgroundColor: '#faf8f0',
                    logging: false
                });

                const link = document.createElement('a');
                const country = document.getElementById('countryEn').value || 'Country';
                link.download = `Sutter_Communique_${country}_${new Date().getFullYear()}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();

                loading.style.display = 'none';
                alert('å»ºäº¤å›½ä¹¦å·²ç”Ÿæˆï¼');
            } catch(err) {
                console.error(err);
                loading.style.display = 'none';
                alert('ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }

        updateDocument();
    </script>
</body>
</html>
